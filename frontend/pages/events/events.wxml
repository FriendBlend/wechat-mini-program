<view class="container">
  <section class="top-section">
    <view class="top-section--background"></view>
    <view class="event-ticket">
      <event></event>
    </view>
    <view class="option-buttons">
      <view class="option-button">
        <image class="option-button--icon" src="/frontend/images/icons/menu.svg"/>
      </view>
      <view class="option-button">
        <image class="option-button--icon" src="/frontend/images/icons/chat.svg"/>
      </view>
    </view>
  </section>

  <view class="bottom-section">
    <view class="tabs">
      <view class="tab {{activeTab == 'future' ? 'active' : ''}}" id="future" bind:tap="tabClick">
        <view class="tab-number">{{futureEventsJoined.length + futureEventsInitiated.length}}</view>
        <view class="tab-text">æœªæ¥äº‹ä»¶</view>
      </view>
      <view class="tab {{activeTab == 'followed' ? 'active' : ''}}" id="followed" bind:tap="tabClick">
        <view class="tab-number">{{followedEvents.length}}</view>
        <view class="tab-text">å…³æ³¨åˆ—è¡¨</view>
      </view>
      <view class="tab {{activeTab == 'history' ? 'active' : ''}}" id="history" bind:tap="tabClick">
        <view class="tab-number">{{historyEventsJoined.length + historyEventsInitiated.length}}</view>
        <view class="tab-text">å†å²äº‹ä»¶</view>
      </view>
    </view>
    <!-- æœç´¢æ¡† -->
    <view class="search-bar-wrapper">
      <input class="search-input" bindinput="onSearchInput" placeholder="ğŸ”æœç´¢" placeholder-class="search-input--placeholder" />
    </view>
    <!-- æœªæ¥äº‹ä»¶ -->
    <view class="future-page" wx:if="{{activeTab == 'future'}}">
      <!-- å‘èµ·/åŠ å…¥é€‰é¡¹ -->
      <view class="small-tabs">
        <view id="init" bind:tap="smallTabClick" class="small-tab {{activeSmallTab == 'init' ? 'small-tab--active' : ''}}">
          <svg class="small-tab--icon" src="/frontend/images/icons/initiated.svg" color="{{activeSmallTab == 'init' ? 'white' : '#333333'}}" height="50rpx" width="50rpx"></svg>
          <view class="small-tab--text">æˆ‘å‘èµ·çš„</view>
        </view>
        <view id="joined" bind:tap="smallTabClick" class="small-tab {{activeSmallTab == 'joined' ? 'small-tab--active' : ''}}">
          <svg class="small-tab--icon" src="/frontend/images/icons/joined.svg" color="{{activeSmallTab == 'joined' ? 'white' : '#333333'}}" height="50rpx" width="50rpx"></svg>
          <view class="small-tab--text">æˆ‘åŠ å…¥çš„</view>
        </view>
      </view>
      <!-- äº‹ä»¶åˆ—è¡¨ -->
      <view class="scroll-view-wrapper">
        <view class="upper-blocker"></view>
        <view class="events-list--header-bg"></view>
        <view class="lower-blocker"></view>
        <scroll-view scroll-y="true" class="events-list" wx:if="{{activeSmallTab == 'init'}}">
          <block wx:for="{{ filteredFutureI }}" wx:key="index">
            <view class="events-list-group">
              <view class="events-list-header">
                <view>{{item[0].partyDate}}</view>
                <view class="events-list-header--month">{{item[0].partyMonth}}æœˆ</view>
              </view>
              <block wx:for="{{item}}" wx:key="index">
                <view class="events-list-item">
                  <event name="{{ item.partyName }}" 
                    avatar="{{ item.partyTypeEng }}" 
                    location="{{item.partyLocation.city}} {{item.partyLocation.district}}"
                    time="{{item.partyAmPm}} {{item.partyTime}}ç‚¹"
                    skin="{{item.partySkin}}"
                  ></event>
                </view>
              </block>
            </view>
          </block>
        </scroll-view>
        <scroll-view scroll-y="true" class="events-list" wx:else >
          <block wx:for="{{ filteredFutureJ }}" wx:key="index">
            <view class="events-list-group">
              <view class="events-list-header">
                <view>{{item[0].partyDate}}</view>
                <view class="events-list-header--month">{{item[0].partyMonth}}æœˆ</view>
              </view>
              <block wx:for="{{item}}" wx:key="index">
                <view class="events-list-item">
                  <event name="{{ item.partyName }}" 
                    avatar="{{ item.partyTypeEng }}" 
                    location="{{item.partyLocation.city}} {{item.partyLocation.district}}"
                    time="{{item.partyAmPm}} {{item.partyTime}}ç‚¹"
                    skin="{{item.partySkin}}"
                  ></event>
                </view>
              </block>
            </view>
          </block>
        </scroll-view>
      </view>
    </view>
    <!-- å…³æ³¨åˆ—è¡¨ -->
    <view class="followed-page" wx:if="{{activeTab == 'followed'}}">
      <view class="followed-page--remarks">å·²ç»ç»“æŸçš„äº‹ä»¶ä¼šè¢«è‡ªåŠ¨ç§»å‡ºå…³æ³¨åˆ—è¡¨</view>
      <block wx:for="{{ filteredFollow }}" wx:key="index">
        <view class="followed-list-item">
          <view class="followed-event">
            <event name="{{ item.partyName }}" 
              avatar="{{ item.partyTypeEng }}" 
              location="{{item.partyLocation.city}} {{item.partyLocation.district}}"
              time="{{item.partyAmPm}} {{item.partyTime}}ç‚¹"
              skin="{{item.partySkin}}"
            ></event>
          </view>
          <view class="followed--option-buttons">
            <view class="followed--option-button">
              <image class="followed--option-button--icon" src="/frontend/images/icons/follow-join.svg"/>
              <view>åŠ å…¥</view>
            </view>
            <view class="followed--option-button">
              <image class="followed--option-button--icon" src="/frontend/images/icons/follow-delete.svg"/>
              <view>ç§»é™¤</view>
            </view>
          </view>
        </view>
      </block>
    </view>
    <!-- å†å²äº‹ä»¶ -->
    <view class="history-page" wx:if="{{activeTab == 'history'}}">
      <!-- å‘èµ·/åŠ å…¥é€‰é¡¹ -->
      <view class="small-tabs">
        <view id="init" bind:tap="smallTabClick" class="small-tab {{activeSmallTab == 'init' ? 'small-tab--active' : ''}}">
          <svg class="small-tab--icon" src="/frontend/images/icons/initiated.svg" color="{{activeSmallTab == 'init' ? 'white' : '#333333'}}" height="50rpx" width="50rpx"></svg>
          <view class="small-tab--text">æˆ‘å‘èµ·çš„</view>
        </view>
        <view id="joined" bind:tap="smallTabClick" class="small-tab {{activeSmallTab == 'joined' ? 'small-tab--active' : ''}}">
          <svg class="small-tab--icon" src="/frontend/images/icons/joined.svg" color="{{activeSmallTab == 'joined' ? 'white' : '#333333'}}" height="50rpx" width="50rpx"></svg>
          <view class="small-tab--text">æˆ‘åŠ å…¥çš„</view>
        </view>
      </view>
      <!-- äº‹ä»¶åˆ—è¡¨ -->
      <view class="scroll-view-wrapper">
        <view class="upper-blocker"></view>
        <view class="events-list--header-bg"></view>
        <view class="lower-blocker"></view>
        <scroll-view scroll-y="true" class="events-list" wx:if="{{activeSmallTab == 'init'}}">
          <block wx:for="{{ filteredHistoryI }}" wx:key="index">
            <view class="events-list-group">
              <view class="events-list-header">
                <view>{{item[0].partyDate}}</view>
                <view class="events-list-header--month">{{item[0].partyMonth}}æœˆ</view>
              </view>
              <block wx:for="{{item}}" wx:key="index">
                <view class="events-list-item">
                  <event name="{{ item.partyName }}" 
                    avatar="{{ item.partyTypeEng }}" 
                    location="{{item.partyLocation.city}} {{item.partyLocation.district}}"
                    time="{{item.partyAmPm}} {{item.partyTime}}ç‚¹"
                    skin="{{item.partySkin}}"
                  ></event>
                </view>
              </block>
            </view>
          </block>
        </scroll-view>
        <scroll-view scroll-y="true" class="events-list" wx:else >
          <block wx:for="{{ filteredHistoryJ }}" wx:key="index">
            <view class="events-list-group">
              <view class="events-list-header">
                <view>{{item[0].partyDate}}</view>
                <view class="events-list-header--month">{{item[0].partyMonth}}æœˆ</view>
              </view>
              <block wx:for="{{item}}" wx:key="index">
                <view class="events-list-item">
                  <event name="{{ item.partyName }}" 
                    avatar="{{ item.partyTypeEng }}" 
                    location="{{item.partyLocation.city}} {{item.partyLocation.district}}"
                    time="{{item.partyAmPm}} {{item.partyTime}}ç‚¹"
                    skin="{{item.partySkin}}"
                  ></event>
                </view>
              </block>
            </view>
          </block>
        </scroll-view>
      </view>
    </view>
  </view>
</view>